import React, { useState } from 'react';
import { FlexCell, PickerInput } from '@epam/uui';
import { DataQueryFilter, useLazyDataSource, useUuiContext } from '@epam/uui-core';
import { Location } from '@epam/uui-docs';

export default function LazyTreePicker() {
    const svc = useUuiContext();
    const [value, onValueChange] = useState<string[]>([
        'FR',
        '3038789',
        '3038712',
        '3038638',
        '3038634',
        '3038354',
        '3038350',
        '3038334',
        '3038266',
        '3038261',
        '3038230',
        '3038213',
        '3038159',
        '3038224',
        '3037854',
        '3037656',
        '3037612',
        '3037598',
        '3037543',
        '3037540',
        '3037538',
        '3037514',
        '3037456',
        '3037423',
        '3037157',
        '3037051',
        '3037044',
        '3036938',
        '3036903',
        '3036784',
        '3036572',
        '3036460',
        '3036433',
        '3036386',
        '3036281',
        '3036240',
        '3036145',
        '3036016',
        '3035883',
        '3035843',
        '3035681',
        '3035667',
        '3035654',
        '3035409',
        '3035403',
        '3035396',
        '3035204',
        '3034911',
        '3034640',
        '3034483',
        '3034475',
        '3034126',
        '3034006',
        '3033791',
        '3033415',
        '3033416',
        '3033391',
        '3033123',
        '3032824',
        '3032797',
        '3032551',
        '3032469',
        '3032340',
        '3032213',
        '3032179',
        '3032070',
        '3031898',
        '3031815',
        '3031709',
        '3031582',
        '3031268',
        '3031137',
        '3031133',
        '3031009',
        '3030990',
        '3030985',
        '3031005',
        '3030960',
        '6615539',
        '3030303',
        '3030300',
        '3030101',
        '3030057',
        '3029974',
        '3029931',
        '3029825',
        '3029748',
        '3029706',
        '3030257',
        '3033881',
        '3033002',
        '3032833',
        '3029276',
        '3029241',
        '3029227',
        '3029213',
        '3029162',
        '3029096',
        '3029030',
        '3028808',
        '3028779',
        '3028641',
        '3028542',
        '3028535',
        '3028521',
        '3028486',
        '3028337',
        '3028263',
        '3028134',
        '3027950',
        '3027883',
        '8555643',
        '3027767',
        '3027763',
        '3027513',
        '3027484',
        '3027453',
        '3027422',
        '3027105',
        '3027014',
        '3026637',
        '3026613',
        '3026467',
        '3026033',
        '3025892',
        '3025715',
        '3025622',
        '3025509',
        '3025496',
        '3025466',
        '3025314',
        '3025144',
        '3025055',
        '3025053',
        '3027487',
        '3026194',
        '3026285',
        '3026204',
        '3026141',
        '3026108',
        '3026083',
        '3024783',
        '3024635',
        '3024597',
        '3024596',
        '3024532',
        '3024440',
        '3024297',
        '3024266',
        '3024223',
        '3024107',
        '3024066',
        '3024035',
        '3023924',
        '3023763',
        '3023645',
        '3023356',
        '3023240',
        '3023141',
        '3022988',
        '3023324',
        '3022700',
        '3022610',
        '3022376',
        '3022569',
        '3022530',
        '3022151',
        '3021852',
        '3021670',
        '3021605',
        '3021516',
        '3021411',
        '3021382',
        '3021372',
        '3021263',
        '3021150',
        '3021000',
        '3020996',
        '3020850',
        '3020839',
        '3020832',
        '3020810',
        '3020686',
        '3021662',
        '3020601',
        '3020307',
        '3019897',
        '3019193',
        '3019153',
        '3018455',
        '3018339',
        '3018280',
        '3018246',
        '3018095',
        '3018074',
        '3017924',
        '3017921',
        '3017910',
        '3017805',
        '3017651',
        '3017609',
        '3017341',
        '3017178',
        '3016956',
        '3017253',
        '3018794',
        '3016830',
        '3016702',
        '3016675',
        '3016667',
        '3016621',
        '3016321',
        '3016292',
        '3016097',
        '3016078',
        '3015902',
        '3015689',
        '3015490',
        '3015419',
        '3015160',
        '3014856',
        '3014728',
        '3014646',
        '3014175',
        '3014143',
        '3014392',
        '3014383',
        '3014078',
        '3014034',
        '3013862',
        '3013681',
        '3013627',
        '3013619',
        '3013549',
        '3013477',
        '3013097',
        '3012937',
        '3013525',
        '3013403',
        '3012834',
        '3012829',
        '3012664',
        '3012649',
        '3012647',
        '3012621',
        '3012313',
        '3012162',
        '3012219',
        '2998632',
        '3019766',
        '3010529',
        '3010237',
        '3010025',
        '3009824',
        '3009791',
        '8504417',
        '3009443',
        '3009223',
        '3009169',
        '3008379',
        '3006767',
        '3006787',
        '3006414',
        '3006283',
        '3005825',
        '3009071',
        '3008218',
        '3007874',
        '3007794',
        '3007609',
        '3007477',
        '3006121',
        '3005866',
        '3005417',
        '3005269',
        '3005066',
        '3004871',
        '3004630',
        '3004427',
        '3003952',
        '3003796',
        '3003737',
        '3003603',
        '3003481',
        '3002984',
        '3002965',
        '3002880',
        '3002650',
        '3002647',
        '3002570',
        '3002499',
        '3002465',
        '2998854',
        '3003093',
        '3001402',
        '3000648',
        '3000491',
        '3000192',
        '3000060',
        '3000047',
        '2999683',
        '6615536',
        '2998975',
        '2998517',
        '2998324',
        '2998311',
        '2998305',
        '2998286',
        '2998224',
        '2998150',
        '2998056',
        '2998431',
        '2997904',
        '2997803',
        '2997712',
        '2997626',
        '2997620',
        '2997577',
        '2997556',
        '2997395',
        '2997336',
        '2997246',
        '2997116',
        '2997110',
        '2996944',
        '2998127',
        '2996568',
        '2996564',
        '2996514',
        '2996255',
        '2996180',
        '2996148',
        '2996146',
        '2995908',
        '2995750',
        '2995652',
        '2995642',
        '2995469',
        '7284882',
        '7284883',
        '7284884',
        '7284885',
        '7284886',
        '7284887',
        '7284888',
        '7284889',
        '7284891',
        '7284890',
        '7284892',
        '7284893',
        '7284894',
        '7284895',
        '7284896',
        '7284897',
        '2995387',
        '2995206',
        '2995150',
        '2995121',
        '2995041',
        '2994935',
        '2994798',
        '2994651',
        '2994497',
        '2994160',
        '2994144',
        '2994087',
        '2994048',
        '2993875',
        '2993760',
        '2993679',
        '2993572',
        '2993207',
        '2992003',
        '2992771',
        '2993024',
        '2993002',
        '2992890',
        '2992938',
        '2992863',
        '2992671',
        '2992650',
        '2992616',
        '2992536',
        '2992415',
        '2992404',
        '2992402',
        '2992367',
        '2992292',
        '2992229',
        '2992166',
        '2992090',
        '2992017',
        '2992703',
        '2991772',
        '2991719',
        '2991551',
        '2991481',
        '2991214',
        '2991153',
        '2996882',
        '2994393',
        '2990999',
        '2990970',
        '2990969',
        '2990919',
        '2990616',
        '2990612',
        '2990611',
        '2990474',
        '2990440',
        '2990355',
        '2990265',
        '2990264',
        '2990192',
        '2990189',
        '2990187',
        '2989877',
        '2990363',
        '2989755',
        '2989611',
        '2989460',
        '2989297',
        '2989317',
        '2989204',
        '2989170',
        '2989130',
        '2988998',
        '2988936',
        '2988888',
        '2988867',
        '2988758',
        '2988670',
        '2988621',
        '2988507',
        '2988358',
        '2987914',
        '2987825',
        '2987805',
        '2987271',
        '2986933',
        '2986930',
        '2986732',
        '2986501',
        '2986495',
        '2986306',
        '2986302',
        '3024195',
        '2986160',
        '2986140',
        '2986025',
        '2985034',
        '2987967',
        '2984701',
        '2984513',
        '2984114',
        '2983990',
        '2983770',
        '2983536',
        '2983489',
        '2983440',
        '2983362',
        '2983276',
        '2983154',
        '2983074',
        '2983026',
        '2983011',
        '2982967',
        '2982944',
        '2982757',
        '2982681',
        '2982652',
        '2982343',
        '2982235',
        '2981839',
        '2981512',
        '2981492',
        '2981280',
        '2981206',
        '2981041',
        '2980942',
        '2980935',
        '2980916',
        '2980816',
        '2980827',
        '2980097',
        '2979985',
        '2979783',
        '2979627',
        '2979590',
        '2979341',
        '2979316',
        '2978891',
        '2978771',
        '2978768',
        '2978742',
        '2978758',
        '2978640',
        '2978621',
        '2978317',
        '2978179',
        '2978100',
        '2977952',
        '2978072',
        '2977921',
        '2977845',
        '2977824',
        '2977800',
        '2977491',
        '2977388',
        '2977356',
        '2977295',
        '8533870',
        '2977246',
        '2976984',
        '2980636',
        '2980291',
        '2980236',
        '2980586',
        '2980558',
        '2980340',
        '2976406',
        '2976341',
        '2976258',
        '2976179',
        '2976050',
        '2976043',
        '2975964',
        '2975921',
        '2975758',
        '2975536',
        '2975525',
        '2975469',
        '2975446',
        '2975349',
        '2975088',
        '2975050',
        '2974681',
        '2974655',
        '2974494',
        '2974427',
        '2974389',
        '2974385',
        '2974188',
        '2974153',
        '2973841',
        '2973783',
        '2973745',
        '2973675',
        '2974733',
        '2974678',
        '2975233',
        '2973495',
        '2973385',
        '2973317',
        '2973258',
        '2973146',
        '2972893',
        '2972811',
        '2972742',
        '2972444',
        '2972350',
        '2972328',
        '2972315',
        '2972284',
        '2972270',
        '2972237',
        '2972191',
        '2972049',
        '2971874',
        '2971549',
        '2971482',
        '2971053',
        '2971041',
        '2970962',
        '2970797',
        '2970777',
        '2970761',
        '2970456',
        '2970432',
        '2970148',
        '2970110',
        '2969958',
        '2969796',
        '2969766',
        '2969692',
        '2969679',
        '2969612',
        '2969562',
        '2969392',
        '2969284',
        '2969257',
        '2969109',
        '2968771',
        '2968748',
        '2968705',
        '2968653',
        '2968620',
        '2968529',
        '6543862',
        '2968555',
        '2968546',
        '2968515',
        '2968496',
        '2968482',
        '2968368',
        '2968254',
        '2968176',
        '2968142',
        '2968054',
        '2967934',
        '2967917',
        '2967870',
        '2967856',
        '2967849',
        '2967879',
        '2967758',
        '2970203',
        '2970072',
        '2967438',
        '2967421',
        '2967318',
        '2967245',
        '3013701',
        '3020495',
        '3020392',
        '3020310',
        '3020062',
        '3020035',
        '3020020',
        '3019960',
        '3019952',
        '3019459',
        '3019265',
        '3019256',
    ]);

    const dataSource = useLazyDataSource<Location, string, DataQueryFilter<Location>>(
        {
            api: (request, ctx) => {
                const { search } = request;
                const filter = search ? {} : { parentId: ctx?.parentId };
                return svc.api.demo.locations({ ...request, search, filter });
            },
            cascadeSelection: true,
            getId: (i) => i.id,
            getParentId: (i) => i.parentId,
            getChildCount: (l) => l.childCount,
        },
        [],
    );

    return (
        <FlexCell width={ 300 }>
            <PickerInput
                dataSource={ dataSource }
                value={ value }
                onValueChange={ onValueChange }
                entityName="location"
                selectionMode="multi"
                valueType="id"
                cascadeSelection="explicit" 
                maxItems={ 1000 }
            />
        </FlexCell>
    );
}
